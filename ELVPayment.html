<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script type="text/javascript">
  var PAYMILL_PUBLIC_KEY = '71850066712bad20cdf3f646c5c74761';
</script>
<script type="text/javascript" src="https://bridge.paymill.com/"></script>
<script type="text/javascript">
$(document).ready(function() {
  $("#payment-form").submit(function(event) {
    // Deactivate submit button to avoid further clicks
    $('.submit-button').attr("disabled", "disabled");
    paymill.createToken({
      iban: $('.elv-iban').val(),  // required, ohne Leerzeichen und Bindestriche
      bic: $('.elv-bic').val(),   // required
      accountholder: $('.elv-account-holder').val(),     // required, vierstellig z.B. "2016"
    }, PaymillResponseHandler);                   // Info dazu weiter unten
    console.log("submit");
    return false;
  });
});
function PaymillResponseHandler(error, result) {
  console.log("PaymillResponseHandler");
  if (error) {
    // Shows the error above the form
    $(".payment-errors").text(error.apierror);
    $(".submit-button").removeAttr("disabled");
    console.log("error: " + error.apierror);
  } else {
    var form = $("#payment-form");
    // Output token
    var token = result.token;
    // Insert token into form in order to submit to server
    console.log(token);
    var user_id = "1"; //user_id des eingeloggten Nutzers hier einfuegen.
    $.ajax({
       type: "GET",
       url: "http://localhost:8080/SharityOnline/payment/" + user_id + "/" + token,
       contentType: "application/json; charset=utf-8",
       dataType: "jsonp",
       data: null,
       success: function (data, status, jqXHR) {
            console.log("success");
       },
       error: function (jqXHR, status) {            
            console.log(status);
       }
    });
    form.append("");
  }
}
</script>
<form id="payment-form" action="#" method="POST">

  <div class="form-row">
    <label>Besitzer</label>
    <input class="elv-account-holder" type="text" value="Alex Tabo" size="20" />
  </div>

  <div class="form-row">
    <label>IBAN</label>
    <input class="elv-iban" type="text" value="DE12500105170648489890" size="22" />
  </div>

  <div class="form-row">
    <label>BIC</label>
    <input class="elv-bic" type="text" value="BENEDEPPYYY" size="12" />
  </div>


  <button class="submit-button" type="submit">Submit</button>

</form>

